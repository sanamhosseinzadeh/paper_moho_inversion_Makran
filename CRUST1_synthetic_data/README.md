# Folder Structure and File Descriptions

This folder contains the datasets, R scripts, and GMT codes used in the section titled  **CRUST1.0 Synthetic Data** of the manuscript. 
The materials are organized into subfolders for forward modeling and inversion. 
Each folder is self-contained, with the corresponding data, scripts, and results provided for transparency and reproducibility.
All resulting figures are saved in their respective folder for easy access.

## forward/  
This folder contains the scripts, data, results, and figures related to the forward gravity modeling process.

- `data/CRUST1_Moho_Model.csv`: Input file defining the CRUST1.0 synthetic Moho model.  
- `R_scripts/Forward.R`: R script to generate the noisy CRUST1.0 synthetic gravity data from the Moho model.  
Note: The script contains paths that must be updated to match your system before running.  
- `results/CRUST1_NSynthetic_Data.csv`: Output noisy CRUST1.0 synthetic gravity data generated by the forward model.  
- `figures_GMT_scripts/figure5a_map_Simple_Moho_Model/a_map.bat`: GMT script to map the CRUST1.0 synthetic Moho model (Figure 5a).  
- `figures_GMT_scripts/figure5a_map_Simple_Moho_Model/b_map.bat`: GMT script to map the CRUST1.0 synthetic gravity data (Figure 5b).  
### Usage
1- run `R_scripts/Forward.R`
- **Input:** `data/CRUST1_Moho_Model.csv`
- **Output:** `data/CRUST1_NSynthetic_Data.csv`

2- run `figures_GMT_scripts/figure5a_map_Simple_Moho_Model/a_map.bat`
- **Input:** `a.txt` that is the txt file of `data/CRUST1_Moho_Model.csv`.
- **Output:** `a.png`

3- run `figures_GMT_scripts/figure5a_map_Simple_Moho_Model/b_map.bat`
- **Input:** `b.txt` that is the txt file of `CRUST1_NSynthetic_Data.csv`.
- **Output:** `b.png`

## inversion/  
This folder contains the scripts, data, results, and figures related to the inversion process using the hybrid DE/PSO metaheuristic algorithm.

- `data/CRUST1_Moho_Model.csv`: Input file defining the CRUST1.0 synthetic Moho model.  
- `data/CRUST1_NSynthetic_Data.csv`: Input file defining the noisy CRUST1.0 synthetic gravity data.  
- `R_scripts/Inversion_Hybrid_Main_Code.R`: Main R script to perform the inversion and save results in the `log/` folder.  
Note: The script contains paths that must be updated to match your system before running.  
- `results/log/P150it5tmax300.log`, `run1.RData`, `P150it5tmax300.pdf`: Output files from the inversion.  
- `results/figure5c_map_GMT_scripts/c_map.bat`: GMT script to map the estimated Moho depths (Figure 5c).  
- `results/figure5d_map_GMT_scripts/d_map.bat`: GMT script to map the calculated data (Figure 5d).  
- `results/figure5e_map_GMT_scripts/e_map.bat`: GMT script to map the Moho depth residuals (Figure 5e).  
- `results/figure5f_map_GMT_scripts/f_map.bat`: GMT script to map the data residuals (Figure 5f).  
- `results/figure6_plots_R_scripts/Figure6_Plots_R_scripts.R`: R script to plot Figure 6.  
Note: Open the `run1.RData` file first, then run this script. It uses the saved workspace variables.  
- `results/output_files_R_scripts/Output_Files_R_scripts.R`: R script to generate `.csv` files containing the inversion results.  
Note: Open the `run1.RData` file first, then run this script. It uses the saved workspace variables.

### Usage
1- run `R_scripts/Inversion_Hybrid_Main_Code.R`
- **Input:** `data/CRUST1_NSynthetic_Data.csv`,`data/CRUST1_Moho_Model.csv` 
- **Output:** log folder including `.log`, `.RData`, and `.pdf` files. `.RData` saves all inversion results.

2- run `results/output_files_R_scripts/Output_Files_R_scripts.R`

Note: Open the output `.RData` workspace file before running
- **Output:** `Caculated_Data.csv`, `Data_Residuals.csv`, `Estimated_Moho_Depths.csv`, and `Moho_Depth_Residuals.csv`

3- run `results/figure5c_map_GMT_scripts/c_map.bat`
- **Input:** `c.txt` that is the txt file of `Estimated_Moho_Depths.csv`.
- **Output:** `c.png`

4- run `results/figure5d_map_GMT_scripts/d_map.bat`
- **Input:** `d.txt` that is the txt file of `Caculated_Data.csv`.
- **Output:** `d.png`

5- run `results/figure5e_map_GMT_scripts/e_map.bat`
- **Input:** `e.txt` that is the txt file of `Moho_Depth_Residuals.csv`.
- **Output:** `e.png`

6- run `results/figure5f_map_GMT_scripts/f_map.bat`
- **Input:** `f.txt` that is the txt file of `Data_Residuals.csv`.
- **Output:** `f.png`

7- run `results/figure6_plots_R_scripts/Figure6_Plots_R_scripts.R`
- **Output:** `Figure6_plot.tiff`

Note: Open the output `.RData` workspace file before running

 ## Reproducibility Note

- The synthetic gravity data were generated by adding randomly simulated noise within the R script.  
Because the noise is created using a random process without a fixed seed, rerunning the forward modeling script may produce slightly different noisy data.  
As a result, the inversion results — including estimated Moho depths and residuals — may also differ slightly from those presented in the paper.  

- The results obtained from the inversion process can vary due to the random nature of the hybrid DE/PSO metaheuristic algorithm.  
Since no fixed seed was set, running the inversion code multiple times may lead to slightly different outcomes, such as variations in the estimated Moho depths and residuals.

The exact figures and values presented in the paper can be reproduced using the provided `.csv`, `.RData`, and output files included in this folder.

## Viewing Saved Variables in `.RData` from the log Folder 

Note: This description applies to all `.RData` files in the different folders within the repository.

To view the variables saved in the `.RData` file, you can open the file located in the `log` folder. 
Use the following command in R to check the saved variables in your workspace:

```r
info
```
This will return:

```r
[1] "Observed"    "Calculated"  "minBound"    "maxBound"    "xObs"       
[6] "yObs"        "x"           "y"           "ControlPar"  "Result"     
[11] "ElapsedTime" "minOF"       "BestPar"     "initDE"      "initPSO"    
[16] "H"           "SIGMA"    
```
These variables include input data, control parameters, inversion results. Command of each variable returns its content. 

**Observed**: Contains the observed gravity anomalies used in the inversion process. 

**Calculated** Stores the calculated gravity anomalies based on the model.

**minBound**: Represents the minimum boundary of the model parameters.

**maxBound**: Represents the maximum boundary of the model parameters.

**xObs**: The x-coordinates of the observed gravity data. 

**yObs**: The y-coordinates of the observed gravity data.

**x**: The x-coordinates of the model grid. 

**y**: The y-coordinates of the model grid.

**ControlPar**: The control parameters for the optimization algorithms. 

**Result**: Contains the final inversion results (Moho depths, rms).

**ElapsedTime**: The time taken for the inversion process to complete. 

**minOF**: The minimum objective function (OF) values achieved throgh the iteration of the optimization process (Convergency rate of OF). 

**BestPar**: The best parameters found throgh the iteration of the optimization process.

**initDE**: The initial poulation for the Differential Evolution (DE) algorithm. 

**initPSO**: The initial poulation for the Particle Swarm Optimization (PSO) algorithm.

**H**: The value of the the reference Moho depth related to the model. 

**SIGMA**: The value of density-contrast related to the model.
